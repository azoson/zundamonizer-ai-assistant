# Zunda Notes

Marpスライドにずんだもんと春日部つむぎの会話形式でプレゼンターノートを追加するツールです。

## 機能

- **プレゼンターノート追加**: Marpスライドに、ずんだもんと春日部つむぎのかけあい形式でプレゼンターノートを追加
- **評価**: 追加されたプレゼンターノートの品質を評価
- **改善**: 評価に基づいて、プレゼンターノートを改善
- **ワークフロー**: 上記3つのステップを一連の流れで実行
- **プレビュー**: Marpスライドをプレビュー表示

## 使い方

### インストール

```bash
# リポジトリのルートから
bun install
```

### 環境変数の設定

`.env`ファイルを作成するか、環境変数を直接設定します：

```bash
# OpenAI APIキー（必須）
OPENAI_API_KEY=your-api-key-here

# 使用するモデル（オプション、デフォルトは"gpt-4o"）
OPENAI_MODEL_NAME=gpt-4o
```

サポートされているモデル例：
- gpt-4o (推奨)
- gpt-4-turbo
- gpt-3.5-turbo
- o1-mini (OpenAIのモデル)

**注意**: o1-miniモデルはトークン制限が小さいため、大きなドキュメントや複雑な入力を処理する際にエラーが発生することがあります。この場合、`OPENAI_MODEL_NAME=gpt-4o`に設定することをお勧めします。

o1-miniモデルを使用する場合は、自動的に以下のパラメータ調整が行われます：
- `max_tokens`の代わりに`max_completion_tokens`が使用されます
- `temperature`パラメータは除外されます（このモデルではデフォルト値のみサポート）

### コマンド

#### プレゼンターノートの追加

```bash
bun zunda-notes add path/to/slide.md -o output/slide-with-notes.md
```

オリジナルの資料も参照してより詳細な解説を生成する場合：

```bash
bun zunda-notes add path/to/slide.md path/to/original-document.md -o output/slide-with-notes.md
```

#### プレゼンターノートの評価

```bash
bun zunda-notes evaluate path/to/slide.md path/to/slide-with-notes.md -o evaluation.md
```

#### プレゼンターノートの改善

```bash
bun zunda-notes improve path/to/slide.md path/to/slide-with-notes.md path/to/evaluation.md -o improved.md
```

#### 一連のワークフロー実行

```bash
bun zunda-notes workflow path/to/slide.md -o output-dir
```

元の資料も参照する場合：

```bash
bun zunda-notes workflow path/to/slide.md path/to/original-document.md -o output-dir
```

#### スライドのプレビュー

```bash
bun zunda-notes preview path/to/slide.md
```

## オプション

- `-o, --output <path>`: 出力ファイルパス
- `--zunda-character <n>`: ずんだもんキャラクターの名前をカスタマイズ (デフォルト: "ずんだもん")
- `--tsumugi-character <n>`: 春日部つむぎキャラクターの名前をカスタマイズ (デフォルト: "春日部つむぎ")

## ChatGPTでの利用方法

ずんだもんと春日部つむぎの会話形式でプレゼンターノートを生成するには、ChatGPTなどのAIチャットサービスで以下のプロンプトを使用できます。

### 基本的なプロンプト

```
以下のMarpスライドの各ページに、ずんだもんと春日部つむぎの会話形式でプレゼンターノートを追加してください。

【キャラクター設定】
・ずんだもん: ずんだ餅をこよなく愛する、明るく元気な妖精。東北ずん子の友達で、女の子。「〜のだ」「〜なのだ」という語尾が特徴的。かわいらしく元気な口調で話す。親しみやすく簡潔に、時に例え話を使って分かりやすく説明する。技術的な内容も噛み砕いて表現する。
・春日部つむぎ: お嬢様風の物腰と丁寧な話し方が特徴的な女の子。上品で知的な印象を与える。「〜だよ」「〜だね」などの語尾が特徴的。快活な口調で話す。論理的で体系だった説明を好み、要点をまとめて伝える。専門的な用語も適切に使いながら、深い解説を行う。

【指示】
1. 各スライドの最後に会話形式の解説を追加してください
2. 元のスライドの構造（ページ分け）と内容はそのまま維持してください
3. スライド内容を詳しく説明し、想定される質問とその回答も含めてください
4. 会話は<!-- ずんだもん(emotion): コメント -->と<!-- 春日部つむぎ(emotion): コメント -->の形式で記述してください
5. emotionには(happy)、(sad)、(thinking)、(neutral)、(angry)の感情表現を入れてください
6. 出力は完全なスライド（元のスライド内容＋追加したNote）としてください

【Marpスライド】
ここにMarpスライドを貼り付けてください
```

### より詳細な解説を生成するプロンプト

元のマークダウン資料も参照してより詳細な解説を生成したい場合は、以下のプロンプトを使用できます：

```
以下のMarpスライドと元の資料を参照して、ずんだもんと春日部つむぎの会話形式でプレゼンターノートを追加してください。

【キャラクター設定】
・ずんだもん: ずんだ餅をこよなく愛する、明るく元気な妖精。東北ずん子の友達で、女の子。「〜のだ」「〜なのだ」という語尾が特徴的。かわいらしく元気な口調で話す。親しみやすく簡潔に、時に例え話を使って分かりやすく説明する。技術的な内容も噛み砕いて表現する。
・春日部つむぎ: お嬢様風の物腰と丁寧な話し方が特徴的な女の子。上品で知的な印象を与える。「〜だよ」「〜だね」などの語尾が特徴的。快活な口調で話す。論理的で体系だった説明を好み、要点をまとめて伝える。専門的な用語も適切に使いながら、深い解説を行う。

【指示】
1. 各スライドの最後に会話形式の解説を追加してください
2. 元のスライドの構造（ページ分け）と内容はそのまま維持してください
3. スライド内容を詳しく説明し、元の資料の内容も踏まえて深い解説をしてください
4. 想定される質問とその回答も含めてください
5. 会話は<!-- ずんだもん(emotion): コメント -->と<!-- 春日部つむぎ(emotion): コメント -->の形式で記述してください
6. emotionには(happy)、(sad)、(thinking)、(neutral)、(angry)の感情表現を入れてください
7. 出力は完全なスライド（元のスライド内容＋追加したNote）としてください
8. 各キャラクターの特性を生かした説明をしてください：
   - ずんだもんは簡潔で例え話を使った説明
   - 春日部つむぎは論理的で専門的な説明

【Marpスライド】
ここにMarpスライドを貼り付けてください

【元の資料】
ここに元のマークダウン資料を貼り付けてください
```

### プレゼンターノートを評価するプロンプト

作成したプレゼンターノートの品質を評価するには：

```
以下の元のスライド内容と、ずんだもんと春日部つむぎの会話形式で追加されたプレゼンターノートを評価してください。

以下の観点から10点満点で評価し、それぞれの評価理由と改善点を、ずんだもんと春日部つむぎの会話形式で提案してください：

1. プレゼンターノートはスライドの内容を適切に解説しているか（情報の正確さ）
2. 会話形式は自然で理解しやすいか（会話の自然さ）
3. キャラクターの特徴が適切に表現されているか
4. プレゼンターにとって有用な情報が含まれているか（実用性）
5. 想定される質問とその回答が適切に含まれているか（想定QA）

【元のスライド】
ここに元のスライド内容を貼り付けてください

【プレゼンターノート付きスライド】
ここにプレゼンターノート付きスライドを貼り付けてください

【出力形式】
<!-- ずんだもん(emotion): （発言内容） -->
<!-- 春日部つむぎ(emotion): （発言内容） -->
のような形式で、会話形式の評価と改善提案を行ってください。
```

## パスの扱いについて

このパッケージは、絶対パスを使って各ファイルにアクセスするように設計されています。相対パスで指定された場合でも、内部で自動的に絶対パスに変換されるため、ディレクトリの場所に関係なく確実に動作します。

## 開発

### プロジェクト構造

```
packages/zunda-notes/
├── cli.ts                # コマンドラインインターフェース
├── add-notes.ts          # プレゼンターノート追加機能
├── evaluation.ts         # プレゼンターノート評価機能
├── improve.ts            # プレゼンターノート改善機能
├── character-settings.ts # キャラクター設定
├── prompt-templates.ts   # プロンプトテンプレート
└── utils.ts              # ユーティリティ関数
```

## トラブルシューティング

- **エラー「プレゼンターノートの生成に失敗しました」**: これはOpenAI APIからの応答が空の場合に発生します。モデルをgpt-4oに変更して再試行してください。
- **「Invalid response object from API」エラー**: APIキーが正しく設定されていない可能性があります。`.env`ファイルのAPIキーを確認してください。

## ライセンス

MIT
